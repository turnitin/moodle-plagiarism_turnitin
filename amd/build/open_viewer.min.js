define(["jquery","core/notification"],function(a){return{origreport_open:function(){var n=this;a(document).off("click",".pp_origreport_open").on("click",".pp_origreport_open",function(){for(var e,i=a(this).attr("class").replace(/\s+/," ").split(" "),t=0;t<i.length;t++)-1!==i[t].indexOf("origreport_")&&"pp_origreport_open"!=i[t]&&(e=i[t].split("_"),n.openDV("origreport",e[1],e[2]))})},grademark_open:function(){var n=this;a(document).off("click",".pp_grademark_open").on("click",".pp_grademark_open",function(){for(var e,i=a(this).attr("class").replace(/\s+/," ").split(" "),t=0;t<i.length;t++)-1!==i[t].indexOf("grademark_")&&"pp_grademark_open"!=i[t]&&(e=i[t].split("_"),n.openDV("grademark",e[1],e[2]))})},openDV:function(e,i,t){var n=this,o=window.open("","turnitin_viewer"),r='<div class="tii_dv_loading" style="text-align:center;">',r=(r+='<img src="'+M.cfg.wwwroot+'/plagiarism/turnitin/pix/turnitin-icon.png" style="width:100px; height: 100px">')+('<p style="font-family: Arial, Helvetica, sans-serif;">'+M.str.plagiarism_turnitin.loadingdv+"</p>")+"</div>";a(o.document.body).html(r),a.ajax({type:"POST",url:M.cfg.wwwroot+"/plagiarism/turnitin/ajax.php",dataType:"json",data:{action:"get_dv_html",submissionid:i,dvtype:e,cmid:t,sesskey:M.cfg.sesskey},success:function(e){a(o.document.body).html(r+e),o.document.forms[0].submit(),o.document.close(),n.checkDVClosed(i,t,o)}})},checkDVClosed:function(e,i,t){var n=this;t.closed?n.refreshScores(e,i):setTimeout(function(){n.checkDVClosed(e,i,t)},500)},refreshScores:function(e,i){var t=(new Date).getTime();a.ajax({type:"POST",url:M.cfg.wwwroot+"/plagiarism/turnitin/ajax.php",dataType:"json",data:{action:"update_grade",submission:e,cmid:i,sesskey:M.cfg.sesskey},success:function(){(new Date).getTime()-t<3e3?window.location=window.location+"":Notification.addNotification({message:M.str.plagiarism_turnitin.turnitin_score_refresh_alert,type:"warning"})}})}}});
//# sourceMappingURL=open_viewer.min.js.map