{"version":3,"file":"new_eula_modal.min.js","sources":["../src/new_eula_modal.js"],"sourcesContent":["/**\n * Javascript controller for launching the EULA modal.\n *\n * @copyright Turnitin\n * @author 2023 Isaac Xiong <ixiong@turnitin.com>\n * @module plagiarism_turnitin/new_eula_modal\n */\n\ndefine(['jquery',\n        'core/templates',\n        'core/modal',\n        'core/modal_events',\n        'plagiarism_turnitin/modal_eula_launch',\n        'plagiarism_turnitin/eula_event_listener'\n    ],\n    function($, Templates, Modal, ModalEvents, ModalEulaLaunch, EulaEventListener) {\n        return {\n            newEulaLaunch: function() {\n                var turnitinEulaClass = $(\".pp_turnitin_eula\");\n                turnitinEulaClass.show();\n\n                // Show the 'accept EULA' prompt for new in-page forum replies.\n                $(document).on('mod_forum-post-created', '.forum-post-container', function (event, newid) {\n                    var turnitinEulaClass = $(\"#post-content-\" + newid + \" .pp_turnitin_eula\");\n                    turnitinEulaClass.show();\n                });\n\n                $(document).on('click', '.pp_turnitin_eula_link', function() {\n                    Modal.create({\n                        type: ModalEulaLaunch.TYPE,\n                        template: ModalEulaLaunch.TEMPLATE,\n                        templateContext: {\n                            cmid: $('input[name=\"coursemodule\"]').val(),\n                            wwwroot: M.cfg.wwwroot\n                        },\n                        large: true,\n                    })\n                        .then(function (modal) {\n                            modal.show();\n                            modal.getRoot().find('.modal').addClass('tii_pp_modal_eula');\n                            modal.getRoot().find('.modal-content').addClass('tii_pp_modal_eula_content');\n\n                            modal.getRoot().on(ModalEvents.hidden, function() {\n                                window.location.reload();\n                            });\n\n                            EulaEventListener.attach();\n                        });\n                });\n\n                // Hide the submission form if the user has never accepted or declined the Turnitin EULA.\n                if ($(\".pp_turnitin_eula_ignored\").length > 0) {\n                    if ($('.editsubmissionform').length > 0) {\n                        $('.editsubmissionform').hide();\n                    }\n                    if (turnitinEulaClass.siblings('.mform').length > 0) {\n                        turnitinEulaClass.siblings('.mform').hide();\n                    }\n                }\n            }\n        };\n    });"],"names":["define","$","Templates","Modal","ModalEvents","ModalEulaLaunch","EulaEventListener","newEulaLaunch","turnitinEulaClass","show","document","on","event","newid","create","type","TYPE","template","TEMPLATE","templateContext","cmid","val","wwwroot","M","cfg","large","then","modal","getRoot","find","addClass","hidden","window","location","reload","attach","length","hide","siblings"],"mappings":"AAQAA,4CAAO,CAAC,SACA,iBACA,aACA,oBACA,wCACA,4CAEJ,SAASC,EAAGC,UAAWC,MAAOC,YAAaC,gBAAiBC,yBACjD,CACHC,cAAe,eACPC,kBAAoBP,EAAE,qBAC1BO,kBAAkBC,OAGlBR,EAAES,UAAUC,GAAG,yBAA0B,yBAAyB,SAAUC,MAAOC,OACvDZ,EAAE,iBAAmBY,MAAQ,sBACnCJ,UAGtBR,EAAES,UAAUC,GAAG,QAAS,0BAA0B,WAC9CR,MAAMW,OAAO,CACTC,KAAMV,gBAAgBW,KACtBC,SAAUZ,gBAAgBa,SAC1BC,gBAAiB,CACbC,KAAMnB,EAAE,8BAA8BoB,MACtCC,QAASC,EAAEC,IAAIF,SAEnBG,OAAO,IAENC,MAAK,SAAUC,OACZA,MAAMlB,OACNkB,MAAMC,UAAUC,KAAK,UAAUC,SAAS,qBACxCH,MAAMC,UAAUC,KAAK,kBAAkBC,SAAS,6BAEhDH,MAAMC,UAAUjB,GAAGP,YAAY2B,QAAQ,WACnCC,OAAOC,SAASC,YAGpB5B,kBAAkB6B,eAK1BlC,EAAE,6BAA6BmC,OAAS,IACpCnC,EAAE,uBAAuBmC,OAAS,GAClCnC,EAAE,uBAAuBoC,OAEzB7B,kBAAkB8B,SAAS,UAAUF,OAAS,GAC9C5B,kBAAkB8B,SAAS,UAAUD"}